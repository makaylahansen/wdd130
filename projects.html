<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="resume.css" rel="stylesheet">
    <title>Projects</title>
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
</head>
<body>
    <header>
        <div class="intro">
            <h1>Makayla Hansen</h1>
            <h3>Software Engineering</h3>
            <h4>Emphasis in Full Stack Web Development</h4>
        </div>
        <nav>
            <a href="index.html">Home</a>
            <a href="projects.html">Projects</a>
            <a href="cert.html">Certifications</a>
            <a href="resume.html">Resume</a>
            <a href="contact.html">Contact Me</a>
        </nav>
    </header>
    <main>
        <div class="meal-prep">
            <p>Meal Prep Program</p>
            <py-script>
                """
This is the Meal Prep Program. 
It is meant to solve the problem of trying 
to figure out what to have as a meal.
It is set up to plan for 2 weeks.
It will also take in input in case the user wants to add a meal.
"""

# import the necessary functions: random, and pytest
import random

# import pickle, pickle allows us to take our dictionary and import it into our test function so we can test the formatting
import pickle


# these are the keys that we will use
MEAL_NAME_INDEX = 0
MEAL_TYPE_INDEX = 1
MEAL_PRICE_INDEX = 2

# put main here
def main():
    """
    Beacuse it is the main, this function has no parameters
    Instead it calls the different functions as well as creates the dictionary we will use throughout the program.
    """
    # create the dictionary
    meal_prep_dict = {
        "001": ["Chicken Alfredo", "Dinner", 11.77],
        "002":["Tacos", "Dinner", 14.43],
        "003":["Burger", "Dinner", 17.77],
        "004":["Rice and Chicken", "Dinner", 10.09],
        "005":["Chicken Nuggets", "Dinner", 6.96],
        "006":["Spaghetti", "Dinner", 10.57],
        "007":["Mashed Potatoes", "Dinner", 11.32],
        "008":["Salad", "Lunch", 2.97],
        "009":["Sandwich", "Lunch", 6.67],
        "010":["Baked Potatoes", "Lunch", 10.24],
        "011":["Chicken Burrito", "Lunch", 11.45],
        "012":["Mac and Cheese", "Lunch", 1.24],
        "013":["Lettuce Wrap", "Lunch", 13.43],
        "014":["Pasta Salad", "Lunch", 3.94],
        "015":["Eggs and Ham", "Breakfast", 7.37],
        "016":["Oatmeal", "Breakfast", 3.56],
        "017":["Yogurt", "Breakfast", 5.18],
        "018":["Protein Shake", "Breakfast", 8.97],
        "019":["Waffles", "Breakfast", 5.72],
        "020":["Applesauce", "Breakfast", 3.12],
        "021":["Bacon and Eggs", "Breakfast", 6.82]
    }

    # remember pickle, this is when we use it
    # this will save the dictionary to a file using pickle
    with open("meal_prep_dict.pkl", "wb") as f:
        pickle.dump(meal_prep_dict, f)

    # print the meal options
    print_dictionary(meal_prep_dict)
    print()
    # call check_price funtion for testing
    check_price(meal_prep_dict)
    # add meals if desired
    # not re-named to allow for it to work correctly
    possible_new_meal = input("Would you like to add a meal? (Yes/No): ").lower()
    if possible_new_meal == "yes":
        added_meal_codes = add_meal(meal_prep_dict)
    # in order for meal_plan to successfully be called, we need to make it an empty dictionary in here as well becuase it is a local varible
    added_meal_codes = []
    # create meal plan
    make_plan(meal_prep_dict, added_meal_codes)

# this function will allow us to check that the meal price is under $20
def check_price(meal_prep_dict):
    """
    This function allows us to test that each price is under $20
    Parameters: meal_prep_dict
    """
    for meal_code, details in meal_prep_dict.items():
        price = details[2]
        return price

def print_dictionary(meal_prep_dict):
    """
    This function allows us to easily print the dictionary
    Parameters: meal_prep_dict
    """

    print()
    print("Meal Options:")
    for meal_code, meal_details in meal_prep_dict.items():
        print(f"{meal_details[MEAL_NAME_INDEX]}")

# this function will allow for the user to add to the dictionary.
def add_meal(meal_prep_dict):
    # start value error exception
    try:
        # create empty dictionary that allows us to add to the main dictionary
        added_meal_codes = []
        add_new_meal = "yes"
        # if statement with a while loop nested inside. This will allow for the user to add as many meals as they want as long as they want to.
        if add_new_meal == "yes":
            while True:
                meal_name = input("Enter meal name: ").capitalize()
                meal_type = input("Enter meal type: ").capitalize()
                meal_price = float(input("Enter meal price: "))

                # Generate a unique meal code
                meal_code = str(len(meal_prep_dict) + 1).zfill(3)

                # Add the meal to the dictionary
                meal_prep_dict[meal_code] = [meal_name, meal_type, meal_price]
                added_meal_codes.append(meal_code)
                print()
                add_more = input("Do you want to add another meal? (Yes/No): ").lower()

                if add_more != "yes":
                    break
            return added_meal_codes
        # the elif will print if the user says no 
        elif add_new_meal == "no":
            print("No new meal added.")
        print_dictionary(meal_prep_dict)
    # create the actual exception
    except ValueError as val_err:
        print(val_err)
        print("Please run program again.")
        
# this is where we create the meal plan and establish the rules.
def make_plan(meal_prep_dict, added_meal_codes):
    """
    This function will allow us to create the different rules.
    Rules:
    Can't have the same meal in the same week.
    Parameters: meal_prep_dict and add_meal_codes
    """

    # start creating the plan
    print()
    print("It is time to make your 2 week meal plan!")
    print("Exciting right?")
    print("Let's begin!")

    # initialize lists to keep track of selected meals for each meal type in the past week
    selected_breakfasts = []
    selected_lunches = []
    selected_dinners = []

    # this creates the count so we have accurate dates.
    count = 0
    # this will be for all the meals
    for i in range(14):
        # get the correct day
        count += 1
        
        # initialize meal options for each meal type
        breakfast_options = {}
        lunch_options = {}
        dinner_options = {}

        # Filter breakfast options from meal_prep_dict and added_meal_codes
        for meal_code, details in meal_prep_dict.items():
            if details[MEAL_TYPE_INDEX] == "Breakfast" and meal_code not in selected_breakfasts:
                breakfast_options[meal_code] = details
        for meal_code in added_meal_codes:
            if meal_prep_dict[meal_code][MEAL_TYPE_INDEX] == "Breakfast":
                breakfast_options[meal_code] = meal_prep_dict[meal_code]

        # Filter lunch options from meal_prep_dict and added_meal_codes
        for meal_code, details in meal_prep_dict.items():
            if details[MEAL_TYPE_INDEX] == "Lunch" and meal_code not in selected_lunches:
                lunch_options[meal_code] = details
        for meal_code in added_meal_codes:
            if meal_prep_dict[meal_code][MEAL_TYPE_INDEX] == "Lunch":
                lunch_options[meal_code] = meal_prep_dict[meal_code]

        # Filter dinner options from meal_prep_dict and added_meal_codes
        for meal_code, details in meal_prep_dict.items():
            if details[MEAL_TYPE_INDEX] == "Dinner" and meal_code not in selected_dinners:
                dinner_options[meal_code] = details
        for meal_code in added_meal_codes:
            if meal_prep_dict[meal_code][MEAL_TYPE_INDEX] == "Dinner":
                dinner_options[meal_code] = meal_prep_dict[meal_code]

        # random meal choices
        if breakfast_options and lunch_options and dinner_options:
            random_breakfast_meal_code = random.choice(list(breakfast_options.keys()))
            random_lunch_meal_code = random.choice(list(lunch_options.keys()))
            random_dinner_meal_code = random.choice(list(dinner_options.keys()))
            
            # retrieve meal names from the dictionary using the meal codes
            random_breakfast_meal = breakfast_options[random_breakfast_meal_code][MEAL_NAME_INDEX]
            random_lunch_meal = lunch_options[random_lunch_meal_code][MEAL_NAME_INDEX]
            random_dinner_meal = dinner_options[random_dinner_meal_code][MEAL_NAME_INDEX]

            # add selected meals to the respective lists to keep track of them
            selected_breakfasts.append(random_breakfast_meal_code)
            selected_lunches.append(random_lunch_meal_code)
            selected_dinners.append(random_dinner_meal_code)

            # update selected meals lists to only keep meals from the past week
            if len(selected_breakfasts) > 5:
                selected_breakfasts.pop(0)
            if len(selected_lunches) > 5:
                selected_lunches.pop(0)
            if len(selected_dinners) > 5:
                selected_dinners.pop(0)

            # this is where we print out the meal
            print()
            print(f"Day {count}:")
            print(f"Breakfast: {random_breakfast_meal}")
            print(f"Lunch: {random_lunch_meal}")
            print(f"Dinner: {random_dinner_meal}")

if __name__ == "__main__":
    main()


            </py-script>
            <py-repl></py-repl>

        </div>
    </main>
</body>
</html>